#!/bin/bash
export UUID=${UUID:-''} 
export NEZHA_SERVER=${NEZHA_SERVER:-''} # 哪吒3个变量不全不运行
export NEZHA_PORT=${NEZHA_PORT:-'443'} # 哪吒端口为{443,8443,2096,2087,2083,2053}其中之一时开启tls    
export NEZHA_KEY=${NEZHA_KEY:-''}      # 哪吒客户端密钥
export ARGO_DOMAIN=${ARGO_DOMAIN:-''}  # 固定隧道域名，留空即启用临时隧道
export ARGO_AUTH=${ARGO_AUTH:-''}     # 固定json或token，留空即启用临时隧道
export CFIP=${CFIP:-'na.ma'}          # 优选域名或优选ip
export CFPORT=${CFPORT:-'443'}       # 节点端口
export NAME=${NAME:-''}            # 节点名称前缀
export FILE_PATH=${FILE_PATH:-'./temp'} # 节点文件存放路径，运行文件夹，若需要改，index.js中也需要和此处一致，否则无法订阅
export ARGO_PORT=${ARGO_PORT:-'8001'}  # Argo端口，使用固定隧道token需在cf后台设置的端口和这里一致

echo "aWYgWyAhIC1kICIke0ZJTEVfUEFUSH0iIF07IHRoZW4KICAgIG1rZGlyICR7RklMRV9QQVRIfQpmaQoKY2xlYW51cF9vbGRmaWxlcygpIHsKICBybSAtcmYgJHtGSUxFX1BBVEh9L2Jvb3QubG9nICR7RklMRV9QQVRIfS9zdWIudHh0ICR7RklMRV9QQVRIfS9jb25maWcuanNvbiAke0ZJTEVfUEFUSH0vdHVubmVsLmpzb24gJHtGSUxFX1BBVEh9L3R1bm5lbC55bWwKfQpjbGVhbnVwX29sZGZpbGVzCndhaXQKCmFyZ29fY29uZmlndXJlKCkgewogIGlmIFtbIC16ICRBUkdPX0FVVEggfHwgLXogJEFSR09fRE9NQUlOIF1dOyB0aGVuCiAgICBlY2hvIC1lICJcZVsxOzMybUFSR09fRE9NQUlOIG9yIEFSR09fQVVUSCB2YXJpYWJsZSBpcyBlbXB0eSwgdXNlIHF1aWNrIHR1bm5lbHNcZVswbSIKICAgIHJldHVybgogIGZpCgogIGlmIFtbICRBUkdPX0FVVEggPX4gVHVubmVsU2VjcmV0IF1dOyB0aGVuCiAgICBlY2hvICRBUkdPX0FVVEggPiAke0ZJTEVfUEFUSH0vdHVubmVsLmpzb24KICAgIGNhdCA+ICR7RklMRV9QQVRIfS90dW5uZWwueW1sIDw8IEVPRgp0dW5uZWw6ICQoY3V0IC1kXCIgLWYxMiA8PDwgIiRBUkdPX0FVVEgiKQpjcmVkZW50aWFscy1maWxlOiAke0ZJTEVfUEFUSH0vdHVubmVsLmpzb24KcHJvdG9jb2w6IGh0dHAyCgppbmdyZXNzOgogIC0gaG9zdG5hbWU6ICRBUkdPX0RPTUFJTgogICAgc2VydmljZTogaHR0cDovL2xvY2FsaG9zdDokQVJHT19QT1JUCiAgICBvcmlnaW5SZXF1ZXN0OgogICAgICBub1RMU1ZlcmlmeTogdHJ1ZQogIC0gc2VydmljZTogaHR0cF9zdGF0dXM6NDA0CkVPRgogIGVsc2UKICAgIGVjaG8gLWUgIlxlWzE7MzJtQVJHT19BVVRIIG1pc21hdGNoIFR1bm5lbFNlY3JldCx1c2UgdG9rZW4gY29ubmVjdCB0byB0dW5uZWxcZVswbSIKICBmaQp9CmFyZ29fY29uZmlndXJlCndhaXQKCmdlbmVyYXRlX2NvbmZpZygpIHsKICBjYXQgPiAke0ZJTEVfUEFUSH0vY29uZmlnLmpzb24gPDwgRU9GCnsKICAibG9nIjogeyAiYWNjZXNzIjogIi9kZXYvbnVsbCIsICJlcnJvciI6ICIvZGV2L251bGwiLCAibG9nbGV2ZWwiOiAibm9uZSIgfSwKICAiaW5ib3VuZHMiOiBbCiAgICB7CiAgICAgICJwb3J0IjogJEFSR09fUE9SVCwKICAgICAgInByb3RvY29sIjogInZsZXNzIiwKICAgICAgInNldHRpbmdzIjogewogICAgICAgICJjbGllbnRzIjogW3sgImlkIjogIiR7VVVJRH0iLCAiZmxvdyI6ICJ4dGxzLXJwcngtdmlzaW9uIiB9XSwKICAgICAgICAiZGVjcnlwdGlvbiI6ICJub25lIiwKICAgICAgICAiZmFsbGJhY2tzIjogWwogICAgICAgICAgeyAiZGVzdCI6IDMwMDEgfSwgeyAicGF0aCI6ICIvdmxlc3MtYXJnbyIsICJkZXN0IjogMzAwMiB9LAogICAgICAgICAgeyAicGF0aCI6ICIvdm1lc3MtYXJnbyIsICJkZXN0IjogMzAwMyB9LCB7ICJwYXRoIjogIi90cm9qYW4tYXJnbyIsICJkZXN0IjogMzAwNCB9CiAgICAgICAgXQogICAgICB9LAogICAgICAic3RyZWFtU2V0dGluZ3MiOiB7ICJuZXR3b3JrIjogInRjcCIgfQogICAgfSwKICAgIHsKICAgICAgInBvcnQiOiAzMDAxLCAibGlzdGVuIjogIjEyNy4wLjAuMSIsICJwcm90b2NvbCI6ICJ2bGVzcyIsCiAgICAgICJzZXR0aW5ncyI6IHsgImNsaWVudHMiOiBbeyAiaWQiOiAiJHtVVUlEfSIgfV0sICJkZWNyeXB0aW9uIjogIm5vbmUiIH0sCiAgICAgICJzdHJlYW1TZXR0aW5ncyI6IHsgIm5ldHdvcmsiOiAid3MiLCAic2VjdXJpdHkiOiAibm9uZSIgfQogICAgfSwKICAgIHsKICAgICAgInBvcnQiOiAzMDAyLCAibGlzdGVuIjogIjEyNy4wLjAuMSIsICJwcm90b2NvbCI6ICJ2bGVzcyIsCiAgICAgICJzZXR0aW5ncyI6IHsgImNsaWVudHMiOiBbeyAiaWQiOiAiJHtVVUlEfSIsICJsZXZlbCI6IDAgfV0sICJkZWNyeXB0aW9uIjogIm5vbmUiIH0sCiAgICAgICJzdHJlYW1TZXR0aW5ncyI6IHsgIm5ldHdvcmsiOiAid3MiLCAic2VjdXJpdHkiOiAibm9uZSIsICJ3c1NldHRpbmdzIjogeyAicGF0aCI6ICIvdmxlc3MtYXJnbyIgfSB9LAogICAgICAic25pZmZpbmciOiB7ICJlbmFibGVkIjogdHJ1ZSwgImRlc3RPdmVycmlkZSI6IFsiaHR0cCIsICJ0bHMiLCAicXVpYyJdLCAibWV0YWRhdGFPbmx5IjogZmFsc2UgfQogICAgfSwKICAgIHsKICAgICAgInBvcnQiOiAzMDAzLCAibGlzdGVuIjogIjEyNy4wLjAuMSIsICJwcm90b2NvbCI6ICJ2bWVzcyIsCiAgICAgICJzZXR0aW5ncyI6IHsgImNsaWVudHMiOiBbeyAiaWQiOiAiJHtVVUlEfSIsICJhbHRlcklkIjogMCB9XSB9LAogICAgICAic3RyZWFtU2V0dGluZ3MiOiB7ICJuZXR3b3JrIjogIndzIiwgIndzU2V0dGluZ3MiOiB7ICJwYXRoIjogIi92bWVzcy1hcmdvIiB9IH0sCiAgICAgICJzbmlmZmluZyI6IHsgImVuYWJsZWQiOiB0cnVlLCAiZGVzdE92ZXJyaWRlIjogWyJodHRwIiwgInRscyIsICJxdWljIl0sICJtZXRhZGF0YU9ubHkiOiBmYWxzZSB9CiAgICB9LAogICAgewogICAgICAicG9ydCI6IDMwMDQsICJsaXN0ZW4iOiAiMTI3LjAuMC4xIiwgInByb3RvY29sIjogInRyb2phbiIsCiAgICAgICJzZXR0aW5ncyI6IHsgImNsaWVudHMiOiBbeyAicGFzc3dvcmQiOiAiJHtVVUlEfSIgfV0gfSwKICAgICAgInN0cmVhbVNldHRpbmdzIjogeyAibmV0d29yayI6ICJ3cyIsICJzZWN1cml0eSI6ICJub25lIiwgIndzU2V0dGluZ3MiOiB7ICJwYXRoIjogIi90cm9qYW4tYXJnbyIgfSB9LAogICAgICAic25pZmZpbmciOiB7ICJlbmFibGVkIjogdHJ1ZSwgImRlc3RPdmVycmlkZSI6IFsiaHR0cCIsICJ0bHMiLCAicXVpYyJdLCAibWV0YWRhdGFPbmx5IjogZmFsc2UgfQogICAgfQogIF0sCiAgImRucyI6IHsgInNlcnZlcnMiOiBbImh0dHBzK2xvY2FsOi8vOC44LjguOC9kbnMtcXVlcnkiXSB9LAogICAib3V0Ym91bmRzIjogWwogICAgICAgIHsKICAgICAgICAgICAgInByb3RvY29sIjogImZyZWVkb20iLAogICAgICAgICAgICAidGFnIjogImRpcmVjdCIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgInByb3RvY29sIjogImJsYWNraG9sZSIsCiAgICAgICAgICAgICJ0YWciOiAiYmxvY2siCiAgICAgICAgfQogICAgXQp9CkVPRgp9CmdlbmVyYXRlX2NvbmZpZwp3YWl0CgpBUkNIPSQodW5hbWUgLW0pICYmIERPV05MT0FEX0RJUj0iJHtGSUxFX1BBVEh9IiAmJiBta2RpciAtcCAiJERPV05MT0FEX0RJUiIgJiYgRklMRV9JTkZPPSgpCmlmIFsgIiRBUkNIIiA9PSAiYXJtIiBdIHx8IFsgIiRBUkNIIiA9PSAiYXJtNjQiIF0gfHwgWyAiJEFSQ0giID09ICJhYXJjaDY0IiBdOyB0aGVuCiAgICBGSUxFX0lORk89KCJodHRwczovL2dpdGh1Yi5jb20vZW9vY2UvdGVzdC9yZWxlYXNlcy9kb3dubG9hZC9BUk0vc2VydmVyIGJvdCIgImh0dHBzOi8vZ2l0aHViLmNvbS9lb29jZS90ZXN0L3JlbGVhc2VzL2Rvd25sb2FkL0FSTS93ZWIgd2ViIiAiaHR0cHM6Ly9naXRodWIuY29tL3RyYW5jZWRqMjAyMi90ZXN0L3JlbGVhc2VzL2Rvd25sb2FkL2FybTY0L3N3aXRoIG5wbSIpCmVsaWYgWyAiJEFSQ0giID09ICJhbWQ2NCIgXSB8fCBbICIkQVJDSCIgPT0gIng4Nl82NCIgXSB8fCBbICIkQVJDSCIgPT0gIng4NiIgXTsgdGhlbgogICAgRklMRV9JTkZPPSgiaHR0cHM6Ly9naXRodWIuY29tL2Vvb2NlL3Rlc3QvcmF3L21haW4vc2VydmVyIGJvdCIgImh0dHBzOi8vZ2l0aHViLmNvbS9lb29jZS90ZXN0L3Jhdy9tYWluL3dlYiB3ZWIiICJodHRwczovL2dpdGh1Yi5jb20vdHJhbmNlZGoyMDIyL3Rlc3QvcmVsZWFzZXMvZG93bmxvYWQvYW1kNjQvc3dpdGggbnBtIikKZWxzZQogICAgZWNobyAiVW5zdXBwb3J0ZWQgYXJjaGl0ZWN0dXJlOiAkQVJDSCIKICAgIGV4aXQgMQpmaQpmb3IgZW50cnkgaW4gIiR7RklMRV9JTkZPW0BdfSI7IGRvCiAgICBVUkw9JChlY2hvICIkZW50cnkiIHwgY3V0IC1kICcgJyAtZiAxKQogICAgTkVXX0ZJTEVOQU1FPSQoZWNobyAiJGVudHJ5IiB8IGN1dCAtZCAnICcgLWYgMikKICAgIEZJTEVOQU1FPSIkRE9XTkxPQURfRElSLyRORVdfRklMRU5BTUUiCiAgICBpZiBbIC1lICIkRklMRU5BTUUiIF07IHRoZW4KICAgICAgICBlY2hvIC1lICJcZVsxOzMybSRGSUxFTkFNRSBhbHJlYWR5IGV4aXN0cyxTa2lwcGluZyBkb3dubG9hZFxlWzBtIgogICAgZWxzZQogICAgICAgIGN1cmwgLUwgLXNTIC1vICIkRklMRU5BTUUiICIkVVJMIgogICAgICAgIGVjaG8gLWUgIlxlWzE7MzJtRG93bmxvYWRpbmcgJEZJTEVOQU1FXGVbMG0iCiAgICBmaQpkb25lCndhaXQKCnJ1bigpIHsKICBpZiBbIC1lICIke0ZJTEVfUEFUSH0vbnBtIiBdOyB0aGVuCiAgICBjaG1vZCA3NzcgIiR7RklMRV9QQVRIfS9ucG0iCiAgICB0bHNQb3J0cz0oIjQ0MyIgIjg0NDMiICIyMDk2IiAiMjA4NyIgIjIwODMiICIyMDUzIikKICAgIGlmIFtbICIke3Rsc1BvcnRzWypdfSIgPX4gIiR7TkVaSEFfUE9SVH0iIF1dOyB0aGVuCiAgICAgIE5FWkhBX1RMUz0iLS10bHMiCiAgICBlbHNlCiAgICAgIE5FWkhBX1RMUz0iIgogICAgZmkKICAgIGlmIFsgLW4gIiRORVpIQV9TRVJWRVIiIF0gJiYgWyAtbiAiJE5FWkhBX1BPUlQiIF0gJiYgWyAtbiAiJE5FWkhBX0tFWSIgXTsgdGhlbgogICAgICAgIG5vaHVwICIke0ZJTEVfUEFUSH0vbnBtIiAtcyAke05FWkhBX1NFUlZFUn06JHtORVpIQV9QT1JUfSAtcCAke05FWkhBX0tFWX0gJHtORVpIQV9UTFN9ID4vZGV2L251bGwgMj4mMSAmCgkJICAgc2xlZXAgMgogICAgICAgIGVjaG8gLWUgIlxlWzE7MzJtbnBtIGlzIHJ1bm5pbmdcZVswbSIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICJcZVsxOzM1bU5FWkhBIHZhcmlhYmxlIGlzIGVtcHR5LHNraXBpbmcgcnVuaW5nXGVbMG0iCiAgICBmaQogIGZpCgogIGlmIFsgLWUgIiR7RklMRV9QQVRIfS93ZWIiIF07IHRoZW4KICAgIGNobW9kIDc3NyAiJHtGSUxFX1BBVEh9L3dlYiIKICAgIG5vaHVwICIke0ZJTEVfUEFUSH0vd2ViIiAtYyAke0ZJTEVfUEFUSH0vY29uZmlnLmpzb24gPi9kZXYvbnVsbCAyPiYxICYKCSBzbGVlcCAyCiAgICBlY2hvIC1lICJcZVsxOzMybXdlYiBpcyBydW5uaW5nXGVbMG0iCiAgZmkKCiAgaWYgWyAtZSAiJHtGSUxFX1BBVEh9L2JvdCIgXTsgdGhlbgogICAgY2htb2QgNzc3ICIke0ZJTEVfUEFUSH0vYm90IgogICAgaWYgW1sgJEFSR09fQVVUSCA9fiBeW0EtWjAtOWEtej1dezEyMCwyNTB9JCBdXTsgdGhlbgogICAgICBhcmdzPSJ0dW5uZWwgLS1lZGdlLWlwLXZlcnNpb24gYXV0byAtLW5vLWF1dG91cGRhdGUgLS1wcm90b2NvbCBodHRwMiBydW4gLS10b2tlbiAke0FSR09fQVVUSH0iCiAgICBlbGlmIFtbICRBUkdPX0FVVEggPX4gVHVubmVsU2VjcmV0IF1dOyB0aGVuCiAgICAgIGFyZ3M9InR1bm5lbCAtLWVkZ2UtaXAtdmVyc2lvbiBhdXRvIC0tY29uZmlnICR7RklMRV9QQVRIfS90dW5uZWwueW1sIHJ1biIKICAgIGVsc2UKICAgICAgYXJncz0idHVubmVsIC0tZWRnZS1pcC12ZXJzaW9uIGF1dG8gLS1uby1hdXRvdXBkYXRlIC0tcHJvdG9jb2wgaHR0cDIgLS1sb2dmaWxlICR7RklMRV9QQVRIfS9ib290LmxvZyAtLWxvZ2xldmVsIGluZm8gLS11cmwgaHR0cDovL2xvY2FsaG9zdDokQVJHT19QT1JUIgogICAgZmkKICAgIG5vaHVwICIke0ZJTEVfUEFUSH0vYm90IiAkYXJncyA+L2Rldi9udWxsIDI+JjEgJgogICAgc2xlZXAgMgogICAgZWNobyAtZSAiXGVbMTszMm1ib3QgaXMgcnVubmluZ1xlWzBtIgogIGZpCn0gCnJ1bgpzbGVlcCA1CgpmdW5jdGlvbiBnZXRfYXJnb2RvbWFpbigpIHsKICBpZiBbWyAtbiAkQVJHT19BVVRIIF1dOyB0aGVuCiAgICBlY2hvICIkQVJHT19ET01BSU4iCiAgZWxzZQogICAgZ3JlcCAtb0UgJ2h0dHBzOi8vW1s6YWxudW06XStcLi1dK1wudHJ5Y2xvdWRmbGFyZVwuY29tJyAiJHtGSUxFX1BBVEh9L2Jvb3QubG9nIiB8IHNlZCAnc0BodHRwczovL0BAJwogIGZpCn0KCmdlbmVyYXRlX2xpbmtzKCkgewogIGFyZ29kb21haW49JChnZXRfYXJnb2RvbWFpbikKICBlY2hvIC1lICJcZVsxOzMybUFyZ29Eb21haW46XGVbMTszNW0ke2FyZ29kb21haW59XGVbMG0iCiAgc2xlZXAgMgoKICBpc3A9JChjdXJsIC1zIGh0dHBzOi8vc3BlZWQuY2xvdWRmbGFyZS5jb20vbWV0YSB8IGF3ayAtRlwiICd7cHJpbnQgJDI2Ii0iJDE4fScgfCBzZWQgLWUgJ3MvIC9fL2cnKQogIHNsZWVwIDIKCiAgVk1FU1M9InsgXCJ2XCI6IFwiMlwiLCBcInBzXCI6IFwiJHtOQU1FfS0ke2lzcH1cIiwgXCJhZGRcIjogXCIke0NGSVB9XCIsIFwicG9ydFwiOiBcIiR7Q0ZQT1JUfVwiLCBcImlkXCI6IFwiJHtVVUlEfVwiLCBcImFpZFwiOiBcIjBcIiwgXCJzY3lcIjogXCJub25lXCIsIFwibmV0XCI6IFwid3NcIiwgXCJ0eXBlXCI6IFwibm9uZVwiLCBcImhvc3RcIjogXCIke2FyZ29kb21haW59XCIsIFwicGF0aFwiOiBcIi92bWVzcy1hcmdvP2VkPTIwNDhcIiwgXCJ0bHNcIjogXCJ0bHNcIiwgXCJzbmlcIjogXCIke2FyZ29kb21haW59XCIsIFwiYWxwblwiOiBcIlwiIH0iCgogIGNhdCA+ICR7RklMRV9QQVRIfS9saXN0LnR4dCA8PEVPRgp2bGVzczovLyR7VVVJRH1AJHtDRklQfToke0NGUE9SVH0/ZW5jcnlwdGlvbj1ub25lJnNlY3VyaXR5PXRscyZzbmk9JHthcmdvZG9tYWlufSZ0eXBlPXdzJmhvc3Q9JHthcmdvZG9tYWlufSZwYXRoPSUyRnZsZXNzLWFyZ28lM0ZlZCUzRDIwNDgjJHtOQU1FfS0ke2lzcH0KCnZtZXNzOi8vJChlY2hvICIkVk1FU1MiIHwgYmFzZTY0IC13MCkKCnRyb2phbjovLyR7VVVJRH1AJHtDRklQfToke0NGUE9SVH0/c2VjdXJpdHk9dGxzJnNuaT0ke2FyZ29kb21haW59JnR5cGU9d3MmaG9zdD0ke2FyZ29kb21haW59JnBhdGg9JTJGdHJvamFuLWFyZ28lM0ZlZCUzRDIwNDgjJHtOQU1FfS0ke2lzcH0KRU9GCgogIGJhc2U2NCAtdzAgJHtGSUxFX1BBVEh9L2xpc3QudHh0ID4gJHtGSUxFX1BBVEh9L3N1Yi50eHQKICBjYXQgJHtGSUxFX1BBVEh9L3N1Yi50eHQKICBlY2hvIC1lICJcblxlWzE7MzJtJHtGSUxFX1BBVEh9L3N1Yi50eHQgc2F2ZWQgc3VjY2Vzc2Z1bGx5XGVbMG0iCiAgc2xlZXAgNSAgCiAgcm0gLXJmICR7RklMRV9QQVRIfS9saXN0LnR4dCAke0ZJTEVfUEFUSH0vYm9vdC5sb2cgJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uICR7RklMRV9QQVRIfS90dW5uZWwuanNvbiAke0ZJTEVfUEFUSH0vdHVubmVsLnltbAp9CmdlbmVyYXRlX2xpbmtzCmVjaG8gLWUgIlxlWzE7OTZtUnVubmluZyBkb25lIVxlWzBtIgplY2hvIC1lICJcZVsxOzk2bVRoYW5rIHlvdSBmb3IgdXNpbmcgdGhpcyBzY3JpcHQsZW5qb3khXGVbMG0iCnNsZWVwIDEwCmNsZWFyCgplY2hvIC1lICJcZVsxOzk2bUFwcCBpcyBydW5uaW5nIVxlWzBtIg==" | base64 -d | bash
